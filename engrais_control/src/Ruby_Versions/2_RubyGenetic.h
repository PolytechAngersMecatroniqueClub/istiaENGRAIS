//********************************************************************************************************
#ifndef RUBY_GENETIC
#define RUBY_GENETIC

#include <iostream>
#include <vector>
#include <algorithm>
#include <sensor_msgs/LaserScan.h>


#include "../Point.h"
#include "../WeightedPoint.h"
#include "../Utility.h"
#include "../Model.h"
#include "../Pearl.h"

class RubyGenetic : public Pearl{
	public:
		std::vector<Point> initialField;
		double distanceToBeConsideredSamePoint = 0.1; 

	public:
		//------------------------------------------------------------------------------------------------
		RubyGenetic();
		//------------------------------------------------------------------------------------------------
		void populateOutliers(const sensor_msgs::LaserScan & );
		//------------------------------------------------------------------------------------------------
		std::pair<Model, Model> findLines();
		//------------------------------------------------------------------------------------------------
		std::vector<Point> getInitialField() const ;

	public:
		//################################################################################################

		//------------------------------------------------------------------------------------------------
		std::vector<Point> randomPointsInField(const int);
		//------------------------------------------------------------------------------------------------
		void searchModels(const int );

		//################################################################################################

		//------------------------------------------------------------------------------------------------
		double calculateEnergy();
		//------------------------------------------------------------------------------------------------
		double meanNumbOfPoints();

		//################################################################################################
		
		//------------------------------------------------------------------------------------------------
		std::vector<int> countParallelLines();
		//------------------------------------------------------------------------------------------------
		std::pair<Model, Model> eraseBadModels();

		//################################################################################################
		
		friend std::ostream & operator << (std::ostream &out, const RubyGenetic &r);
};

inline RubyGenetic::RubyGenetic(){}

inline std::vector<Point> RubyGenetic::getInitialField() const { return initialField; }

#endif
//********************************************************************************************************