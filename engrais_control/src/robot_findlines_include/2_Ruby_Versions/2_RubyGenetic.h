//********************************************************************************************************
#ifndef RUBY_GENETIC
#define RUBY_GENETIC

#include <iostream>
#include <vector>
#include <algorithm>
#include <sensor_msgs/LaserScan.h>


#include "../../include/1_Point/Point.h"
#include "../../include/3_Utility/Utility.h"
#include "../../include/4_Model/Model.h"
#include "../1_Pearl/Pearl.h"

class RubyGenetic : public Pearl{
	private:

		double numberOfModelsToSearch = 40;
		double factorToDeletePoints = 0.8;

	public:
		//------------------------------------------------------------------------------------------------
		RubyGenetic();
		//------------------------------------------------------------------------------------------------
		void populateOutliers(const sensor_msgs::LaserScan & );
		//------------------------------------------------------------------------------------------------
		std::vector<Model> findLines();


	private:
		//################################################################################################

		//------------------------------------------------------------------------------------------------
		std::vector<Point> randomPointsInField(const int) const;
		//------------------------------------------------------------------------------------------------
		void searchModels(const int );

		//################################################################################################

		//------------------------------------------------------------------------------------------------
		double calculateEnergy() const;
		//------------------------------------------------------------------------------------------------
		double meanNumbOfPoints() const;

		//################################################################################################
		
		//------------------------------------------------------------------------------------------------
		void countParallelLines();
		//------------------------------------------------------------------------------------------------
		void eraseBadModels();

		//################################################################################################
		
		friend std::ostream & operator << (std::ostream &out, const RubyGenetic &r);
};


//--------------------------------------------------------------------------------------------------------
inline RubyGenetic::RubyGenetic(){}

#endif
//********************************************************************************************************